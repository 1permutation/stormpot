<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_20) on Wed May 18 11:21:45 CEST 2011 -->
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>
PoolTest (stormpot 1.0-SNAPSHOT Test API)
</TITLE>

<META NAME="date" CONTENT="2011-05-18">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="PoolTest (stormpot 1.0-SNAPSHOT Test API)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/PoolTest.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../stormpot/PoolFixtures.html" title="class in stormpot"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../stormpot/UnitKit.html" title="class in stormpot"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../index.html?stormpot/PoolTest.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="PoolTest.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
stormpot</FONT>
<BR>
Class PoolTest</H2>
<PRE>
<A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</A>
  <IMG SRC="../resources/inherit.gif" ALT="extended by "><B>stormpot.PoolTest</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>PoolTest</B><DT>extends <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></DL>
</PRE>

<P>
This is the generic test for Pool implementations. The test ensures that
 an implementation adheres to the general contract of the Pool interface,
 given certain circumstances and standardised configurations.
 <p>
 Pools may have other properties, and may be configurable to deviate from
 the standardised behaviour. However, such properties must not be
 observable within the standardised spectrum of configurations.
 <p>
 The tests for any special properties that a pool may have, must be put in
 a pool-specific test case. Do not use assumptions or other tricks to
 pollute this test case with tests for pool-specific or non-standard
 behaviours and configurations.
 <p>
 The test case uses theories to apply to the set of possible Pool
 implementations. Each implementation must have a PoolFixture, which is
 used to construct and initialise the pool, based on a <A HREF="../../apidocs/stormpot/Config.html?is-external=true" title="class or interface in stormpot"><CODE>Config</CODE></A>.
 <p>
 The only assumptions used in this test, is whether the Pool is a
 LifecycledPool or not. And most interesting pools are life-cycled.
 LifecycledPools can be shut down. This is a required ability, in order to
 test a number of behaviours, but also brings about its own set of new
 behaviours and flows that needs to be tested for. Those tests are also
 included in this test case.
 <p>
 <strong>Note:</strong> when adding, removing or modifying tests, also
 remember to update the <A HREF="../../apidocs/stormpot/Pool.html?is-external=true" title="class or interface in stormpot"><CODE>Pool</CODE></A> javadoc - especially the part about
 what promises are provided by the Pool interface and its implementations.
<P>

<P>
<DL>
<DT><B>Author:</B></DT>
  <DD>Chris Vest &lt;mr.chrisvest@gmail.com&gt;</DD>
<DT><B>See Also:</B><DD><A HREF="../../apidocs/stormpot/Pool.html?is-external=true" title="class or interface in stormpot"><CODE>Pool</CODE></A></DL>
<HR>

<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#PoolTest()">PoolTest</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#awaitCompletionWithNullTimeUnitMustThrow(stormpot.PoolFixture)">awaitCompletionWithNullTimeUnitMustThrow</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;One must provide a TimeUnit argument when awaiting the completion of a
 shut-down procedure, with a timeout.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#awaitCompletionWithTimeoutLessThanOneMustReturnImmediately(stormpot.PoolFixture)">awaitCompletionWithTimeoutLessThanOneMustReturnImmediately</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When await is called on a shutdown Completion with a timeout value less
 than one, then no amount of waiting must take place.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#awaitingOnAlreadyCompletedShutDownMustNotBlock(stormpot.PoolFixture)">awaitingOnAlreadyCompletedShutDownMustNotBlock</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We have verified that the await methods works as intended, if you
 begin your awaiting while the shut down process is still undergoing.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#awaitOnCompletionMustThrowUponInterruption(stormpot.PoolFixture)">awaitOnCompletionMustThrowUponInterruption</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A thread that is waiting in await, for a completion to finish, must
 throw an InterruptedException if it is interrupted.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#awaitOnCompletionWhenInterruptedMustClearInterruption(stormpot.PoolFixture)">awaitOnCompletionWhenInterruptedMustClearInterruption</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As per the contract of throwing an InterruptedException, if the
 await of an unfinished completion throws an InterruptedException, then
 they must also clear the interrupted status.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#awaitOnCompletionWhenInterruptedMustThrow(stormpot.PoolFixture)">awaitOnCompletionWhenInterruptedMustThrow</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calling await on a completion when your thread is interrupted, must
 throw an InterruptedException.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#awaitOnFinishedCompletionMustClearInterruption(stormpot.PoolFixture)">awaitOnFinishedCompletionMustClearInterruption</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As per the contract of throwing an InterruptedException, the above must
 also clear the threads interrupted status.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#awaitOnFinishedCompletionWhenInterruptedMustThrow(stormpot.PoolFixture)">awaitOnFinishedCompletionWhenInterruptedMustThrow</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calling await on a completion when your thread is interrupted,
 must throw an InterruptedException - even if the shut down procedure
 has completed.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#awaitOnShutdownMustReturnWhenClaimedObjectsAreReleased(stormpot.PoolFixture)">awaitOnShutdownMustReturnWhenClaimedObjectsAreReleased</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We know from the previous test, that awaiting the shut down completion
 will wait for any claimed objects to be released.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#awaitWithTimeoutMustReturnFalseIfTimeoutElapses(stormpot.PoolFixture)">awaitWithTimeoutMustReturnFalseIfTimeoutElapses</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The await with timeout on the Completion of the shut down process
 must return false if the timeout elapses, as is the typical contract
 of such methods in java.util.concurrent.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#awaitWithTimeoutMustReturnTrueIfCompletesWithinTimeout(stormpot.PoolFixture)">awaitWithTimeoutMustReturnTrueIfCompletesWithinTimeout</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We have verified that await with timeout returns false if the timeout
 elapses.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#awaitWithTimeoutOnCompletionMustThrowUponInterruption(stormpot.PoolFixture)">awaitWithTimeoutOnCompletionMustThrowUponInterruption</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A thread that is awaiting the completion of a shut down procedure with
 a timeout, must throw an InterruptedException if it is interrupted.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#awaitWithTimeoutOnCompletionWhenInterruptedMustThrow(stormpot.PoolFixture)">awaitWithTimeoutOnCompletionWhenInterruptedMustThrow</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calling await with timeout on a completion when your thread is
 interrupted must, just as await without timeout, throw an
 InterruptedException</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#awaitWithTimeoutOnFinishedCompletionWhenInterruptedMustThrow(stormpot.PoolFixture)">awaitWithTimeoutOnFinishedCompletionWhenInterruptedMustThrow</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calling await with a timeout on a finished completion when your thread
 is interrupted must, just as with calling await without a timeout,
 throw an InterruptedException.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#blockedClaimMustThrowUponInterruption(stormpot.PoolFixture)">blockedClaimMustThrowUponInterruption</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The claim methods checks whether the current thread is interrupted upon
 entry, but perhaps what is more important is the interruption of a claim
 call that is already waiting when the thread is interrupted.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#blockedClaimMustThrowWhenPoolIsShutDown(stormpot.PoolFixture)">blockedClaimMustThrowWhenPoolIsShutDown</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A call to claim on a pool that has been, or is in the process of being,
 shut down, will throw an IllegalStateException.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#blockedClaimWithTimeoutMustThrowUponInterruption(stormpot.PoolFixture)">blockedClaimWithTimeoutMustThrowUponInterruption</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#blockedClaimWithTimeoutMustThrowWhenPoolIsShutDown(stormpot.PoolFixture)">blockedClaimWithTimeoutMustThrowWhenPoolIsShutDown</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A thread that is waiting in claim-with-timeout when the pool is shut
 down, must quickly unblock and receive an IllegalStateException.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#blockingClaimMustWaitIfPoolIsEmpty(stormpot.PoolFixture)">blockingClaimMustWaitIfPoolIsEmpty</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If the pool has been depleted for objects, then it is generally the
 contract of claim() to wait until one becomes available.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#blockingClaimWithTimeoutMustWaitIfPoolIsEmpty(stormpot.PoolFixture)">blockingClaimWithTimeoutMustWaitIfPoolIsEmpty</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If the pool has been depleted for objects, then a call to claim with
 timeout will wait until either an object becomes available, or the timeout
 elapses.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#blockingOnClaimMustResumeWhenPoolablesAreReleased(stormpot.PoolFixture)">blockingOnClaimMustResumeWhenPoolablesAreReleased</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When a thread is waiting in claim() on a depleted pool, then it is
 basically waiting for another thread to release an object back into the
 pool.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#blockingOnClaimWithTimeoutMustResumeWhenPoolablesAreReleased(stormpot.PoolFixture)">blockingOnClaimWithTimeoutMustResumeWhenPoolablesAreReleased</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A thread that is waiting in claim-with-timeout on a depleted pool must
 wake up if another thread releases an object back into the pool.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#callingShutdownMustNotAffectInterruptionStatus(stormpot.PoolFixture)">callingShutdownMustNotAffectInterruptionStatus</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initiating the shut-down procedure must not influence the threads
 interruption status.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#claimMustReturnObject(stormpot.PoolFixture)">claimMustReturnObject</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The pool must not return null when we claim an object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#claimMustStayWithinDeadlineEvenIfAllocatorBlocks(stormpot.PoolFixture)">claimMustStayWithinDeadlineEvenIfAllocatorBlocks</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A call to claim with time-out must complete within the time-out period
 even if the Allocator never returns.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#claimMustStayWithinTimeoutEvenIfExpiredObjectIsReleased(stormpot.PoolFixture)">claimMustStayWithinTimeoutEvenIfExpiredObjectIsReleased</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Claim with timeout must adhere to its timeout value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#claimMustThrowIfAllocationReturnsNull(stormpot.PoolFixture)">claimMustThrowIfAllocationReturnsNull</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Allocators must never return <code>null</code>, and if they do, then a
 call to claim must throw a PoolException to indicate this fact.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#claimWhenInterruptedMustThrow(stormpot.PoolFixture)">claimWhenInterruptedMustThrow</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Threads that are already interrupted upon entry to the claim method, must
 promptly be met with an InterruptedException.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#claimWithNullTimeUnitMustThrow(stormpot.PoolFixture)">claimWithNullTimeUnitMustThrow</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;One must provide a TimeUnit to a claim call with timeout.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#claimWithTimeoutMustReturnIfWithinTimeout(stormpot.PoolFixture)">claimWithTimeoutMustReturnIfWithinTimeout</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A call to claim-with-timeout must return before the timeout elapses if it
 can claim an object from the pool, and it must return that object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#claimWithTimeoutMustReturnNullIfTimeoutElapses(stormpot.PoolFixture)">claimWithTimeoutMustReturnNullIfTimeoutElapses</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A call to claim-with-timeout that fails to get an object before the
 timeout elapses, must return null.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#claimWithTimeoutMustThrowIfAllocationReturnsNull(stormpot.PoolFixture)">claimWithTimeoutMustThrowIfAllocationReturnsNull</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Even claim with timeout must throw a PoolException if an Allocator
 returns <code>null</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#claimWithTimeoutValueLessThanOneMustReturnImmediately(stormpot.PoolFixture)">claimWithTimeoutValueLessThanOneMustReturnImmediately</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When claim is called with a timeout less than one, then it means that
 no (observable amount of) waiting should take place.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#claimWithTimeoutWhenInterruptedMustThrow(stormpot.PoolFixture)">claimWithTimeoutWhenInterruptedMustThrow</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#constructorMustThrowOnNullAllocator(stormpot.PoolFixture)">constructorMustThrowOnNullAllocator</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Prevent the creation of pools with a null Allocator.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#constructorMustThrowOnNullTtlUnit(stormpot.PoolFixture)">constructorMustThrowOnNullTtlUnit</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Prevent the creation of pools with a null TTL TimeUnit.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#constructorMustThrowOnPoolSizeLessThanOne(stormpot.PoolFixture)">constructorMustThrowOnPoolSizeLessThanOne</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Be careful and prevent the creation of pools with a size less than one.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#constructorMustThrowOnTtlLessThanOne(stormpot.PoolFixture)">constructorMustThrowOnTtlLessThanOne</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Prevent the creation of pools with a TTL value less than one.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#mustBeAbleToShutDownEvenIfInterrupted(stormpot.PoolFixture)">mustBeAbleToShutDownEvenIfInterrupted</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calling shutdown on a pool while being interrupted must still start the
 shut-down procedure.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#mustCompleteShutDownEvenIfAllSlotsHaveAllocationErrors(stormpot.PoolFixture)">mustCompleteShutDownEvenIfAllSlotsHaveAllocationErrors</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As with
 <A HREF="../stormpot/PoolTest.html#mustCompleteShutDownEvenIfAllSlotsHaveNullErrors(stormpot.PoolFixture)"><CODE>mustCompleteShutDownEvenIfAllSlotsHaveNullErrors(PoolFixture)</CODE></A>,
 the pool must be able to shut down if it has never been able to allocate
 anything.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#mustCompleteShutDownEvenIfAllSlotsHaveNullErrors(stormpot.PoolFixture)">mustCompleteShutDownEvenIfAllSlotsHaveNullErrors</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Even if the Allocator has never made a successful allocation, the pool
 must still be able to complete its shut-down procedure.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#mustDeallocateAllPoolablesBeforeShutdownTaskReturns(stormpot.PoolFixture)">mustDeallocateAllPoolablesBeforeShutdownTaskReturns</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When we call shutdown() on a pool, the shutdown process is initiated and
 the call returns a Completion object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#mustDeallocateExpiredPoolablesAndStayWithinSizeLimit(stormpot.PoolFixture)">mustDeallocateExpiredPoolablesAndStayWithinSizeLimit</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The size limit on a pool is strict, unless specially (as in a
 non-standard way) configured otherwise.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#mustGetPooledObjectsFromAllocator(stormpot.PoolFixture)">mustGetPooledObjectsFromAllocator</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;While the pool mustn't return null when we claim an object, it likewise
 mustn't just come up with any random thing that implements Poolable.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#mustNotDeallocateTheSameObjectMoreThanOnce(stormpot.PoolFixture)">mustNotDeallocateTheSameObjectMoreThanOnce</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Clients might hold on to objects after they have been released.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#mustPropagateExceptionsFromAllocateThroughClaim(stormpot.PoolFixture)">mustPropagateExceptionsFromAllocateThroughClaim</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pools must be prepared in the event that an Allocator throws a
 RuntimeException.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#mustPropagateExceptionsFromAllocateThroughClaimWithTimeout(stormpot.PoolFixture)">mustPropagateExceptionsFromAllocateThroughClaimWithTimeout</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If allocate throws an exception, then a later claim or claim-with-timeout
 must propagate it wrapped in a PoolException.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#mustReplaceExpiredPoolables(stormpot.PoolFixture)">mustReplaceExpiredPoolables</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Objects in the pool only live for a certain amount of time, and then
 they must be replaced/renewed.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#mustReuseAllocatedObjects(stormpot.PoolFixture)">mustReuseAllocatedObjects</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;One uses a pool because a certain type of objects are expensive to
 create and we would like to recycle them.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#mustStillBeUsableAfterExceptionInAllocate(stormpot.PoolFixture)">mustStillBeUsableAfterExceptionInAllocate</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A pool must not break its internal invariants if an Allocator throws an
 exception in allocate, and they must still be usable after the exception
 has bubbled out.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#mustSwallowExceptionsFromDeallocateThroughRelease(stormpot.PoolFixture)">mustSwallowExceptionsFromDeallocateThroughRelease</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We cannot guarantee that exceptions from deallocating objects will
 propagate out through release, because the actual deallocation might be
 done asynchronously in a different thread.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#mustSwallowExceptionsFromDeallocateThroughShutdown(stormpot.PoolFixture)">mustSwallowExceptionsFromDeallocateThroughShutdown</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;While it is technically possible to propagate exceptions from an
 Allocators deallocate method during the shutdown procedure, it would not
 be a desirable behaviour because it would be inconsistent with how this
 works for the release method on Poolable - and Slot, for that matter.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#pools()">pools</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#preventClaimFromPoolThatIsShutDown(stormpot.PoolFixture)">preventClaimFromPoolThatIsShutDown</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;It is not possible to claim from a pool that has been shut down.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#preventClaimWithTimeoutFromPoolThatIsShutDown(stormpot.PoolFixture)">preventClaimWithTimeoutFromPoolThatIsShutDown</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Trying to claim-with-timeout from a pool that has been shut down will
 throw an IllegalStateException.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#setUp()">setUp</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#shutdownCallMustReturnFastIfPoolablesAreStillClaimed(stormpot.PoolFixture)">shutdownCallMustReturnFastIfPoolablesAreStillClaimed</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;So awaiting the shut down completion cannot return before all
 claimed objects are both released and deallocated.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#shutdownMustNotDeallocateClaimedPoolables(stormpot.PoolFixture)">shutdownMustNotDeallocateClaimedPoolables</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We have verified that the call to shutdown on a pool does not block on
 claimed objects, and we have verified that all objects are deallocated
 when the shut down completes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#shutdownMustNotDeallocateEmptySlots(stormpot.PoolFixture)">shutdownMustNotDeallocateEmptySlots</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The shutdown procedure might be tempted to blindly iterate the pool
 data structure and deallocate every possible slot.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../stormpot/PoolTest.html#throwingInterruptedExceptionFromClaimMustClearInterruptedFlag(stormpot.PoolFixture)">throwingInterruptedExceptionFromClaimMustClearInterruptedFlag</A></B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As per the general contract of interruptible methods, throwing an
 InterruptedException will clear the interrupted flag on the thread.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.<A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</A>, <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</A>, <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</A>, <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</A>, <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</A>, <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</A>, <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</A>, <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</A>, <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</A>, <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</A>, <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="PoolTest()"><!-- --></A><H3>
PoolTest</H3>
<PRE>
public <B>PoolTest</B>()</PRE>
<DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="pools()"><!-- --></A><H3>
pools</H3>
<PRE>
public static <A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>[] <B>pools</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="setUp()"><!-- --></A><H3>
setUp</H3>
<PRE>
public void <B>setUp</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="claimMustReturnObject(stormpot.PoolFixture)"><!-- --></A><H3>
claimMustReturnObject</H3>
<PRE>
public void <B>claimMustReturnObject</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                           throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>The pool must not return null when we claim an object. Allocators also
 are not allowed to ever return null (and the one used in this test lives
 up to this promise) so if a null comes out then it means that the path
 from the Allocator out of the pool is somehow broken.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="claimWithTimeoutMustReturnIfWithinTimeout(stormpot.PoolFixture)"><!-- --></A><H3>
claimWithTimeoutMustReturnIfWithinTimeout</H3>
<PRE>
public void <B>claimWithTimeoutMustReturnIfWithinTimeout</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                               throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>A call to claim-with-timeout must return before the timeout elapses if it
 can claim an object from the pool, and it must return that object.
 The timeout for the claim is longer than the timeout for the test, so we
 know that we won't get a null back here because the timeout wasn't long
 enough. If we do, then the pool does not correctly implement the timeout
 behaviour.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="claimWithTimeoutMustReturnNullIfTimeoutElapses(stormpot.PoolFixture)"><!-- --></A><H3>
claimWithTimeoutMustReturnNullIfTimeoutElapses</H3>
<PRE>
public void <B>claimWithTimeoutMustReturnNullIfTimeoutElapses</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                    throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>A call to claim-with-timeout that fails to get an object before the
 timeout elapses, must return null.
 We test this by depleting a pool, and then make a call to claim with
 a shot timeout. If that call returns <code>null</code>, then we're good.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="mustGetPooledObjectsFromAllocator(stormpot.PoolFixture)"><!-- --></A><H3>
mustGetPooledObjectsFromAllocator</H3>
<PRE>
public void <B>mustGetPooledObjectsFromAllocator</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                       throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>While the pool mustn't return null when we claim an object, it likewise
 mustn't just come up with any random thing that implements Poolable.
 The objects have to come from the associated Allocator.
 Or fixtures are required to count all allocations and deallocations,
 so we can measure that our intended interactions do, in fact, reach
 the Allocator. The PoolFixture will typically do this by wrapping the
 source Allocator in a CountingAllocatorWrapper, but that is an
 irrelevant detail.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="blockingClaimMustWaitIfPoolIsEmpty(stormpot.PoolFixture)"><!-- --></A><H3>
blockingClaimMustWaitIfPoolIsEmpty</H3>
<PRE>
public void <B>blockingClaimMustWaitIfPoolIsEmpty</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                        throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>If the pool has been depleted for objects, then it is generally the
 contract of claim() to wait until one becomes available. There might
 be options on pools to allow over-subscription or fail-fast strategies
 to modify the behaviour of claim() but those are not considered in this
 generic PoolTest.
 So if a thread tries to claim from a depleted pool, then the thread must
 be put in the WAITING state because it is waiting for some other thread
 to perform a certain action, namely to release an object.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="blockingClaimWithTimeoutMustWaitIfPoolIsEmpty(stormpot.PoolFixture)"><!-- --></A><H3>
blockingClaimWithTimeoutMustWaitIfPoolIsEmpty</H3>
<PRE>
public void <B>blockingClaimWithTimeoutMustWaitIfPoolIsEmpty</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                   throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>If the pool has been depleted for objects, then a call to claim with
 timeout will wait until either an object becomes available, or the timeout
 elapses. Whichever comes first.
 We test for this by observing that a thread that makes a claim-with-timeout
 call to a depleted pool, will enter the TIMED_WAITING state.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="blockingOnClaimMustResumeWhenPoolablesAreReleased(stormpot.PoolFixture)"><!-- --></A><H3>
blockingOnClaimMustResumeWhenPoolablesAreReleased</H3>
<PRE>
public void <B>blockingOnClaimMustResumeWhenPoolablesAreReleased</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                       throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>When a thread is waiting in claim() on a depleted pool, then it is
 basically waiting for another thread to release an object back into the
 pool. Once this happens, the waiting thread must awaken to resume the
 execution of claim() and get an object back out.
 We only test the awakening here.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="blockingOnClaimWithTimeoutMustResumeWhenPoolablesAreReleased(stormpot.PoolFixture)"><!-- --></A><H3>
blockingOnClaimWithTimeoutMustResumeWhenPoolablesAreReleased</H3>
<PRE>
public void <B>blockingOnClaimWithTimeoutMustResumeWhenPoolablesAreReleased</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                                  throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>A thread that is waiting in claim-with-timeout on a depleted pool must
 wake up if another thread releases an object back into the pool.
 So if we deplete a pool, make a thread wait in claim-with-timeout and
 then release an object back into the pool, then we must be able to join
 to that thread.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="mustReuseAllocatedObjects(stormpot.PoolFixture)"><!-- --></A><H3>
mustReuseAllocatedObjects</H3>
<PRE>
public void <B>mustReuseAllocatedObjects</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                               throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>One uses a pool because a certain type of objects are expensive to
 create and we would like to recycle them. So when we claim and object,
 then release it back into the pool, and then claim and release it again,
 then we must observe that only a single object allocation has taken
 place.
 The pool has a size of 1, so we can safely base this test on the
 allocation count - even for pools that like to eagerly saturate the
 pool with objects.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="constructorMustThrowOnPoolSizeLessThanOne(stormpot.PoolFixture)"><!-- --></A><H3>
constructorMustThrowOnPoolSizeLessThanOne</H3>
<PRE>
public void <B>constructorMustThrowOnPoolSizeLessThanOne</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</PRE>
<DL>
<DD>Be careful and prevent the creation of pools with a size less than one.
 The contract of claim is to block indefinitely if one such pool were
 to be created.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - <DT><B>See Also:</B><DD><A HREF="../../apidocs/stormpot/Config.html?is-external=true#setSize(int)" title="class or interface in stormpot"><CODE>Config.setSize(int)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="constructorMustThrowOnTtlLessThanOne(stormpot.PoolFixture)"><!-- --></A><H3>
constructorMustThrowOnTtlLessThanOne</H3>
<PRE>
public void <B>constructorMustThrowOnTtlLessThanOne</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</PRE>
<DL>
<DD>Prevent the creation of pools with a TTL value less than one.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - <DT><B>See Also:</B><DD><A HREF="../../apidocs/stormpot/Config.html?is-external=true#setTTL(long, java.util.concurrent.TimeUnit)" title="class or interface in stormpot"><CODE>Config.setTTL(long, TimeUnit)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="constructorMustThrowOnNullTtlUnit(stormpot.PoolFixture)"><!-- --></A><H3>
constructorMustThrowOnNullTtlUnit</H3>
<PRE>
public void <B>constructorMustThrowOnNullTtlUnit</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</PRE>
<DL>
<DD>Prevent the creation of pools with a null TTL TimeUnit.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - <DT><B>See Also:</B><DD><A HREF="../../apidocs/stormpot/Config.html?is-external=true#setTTL(long, java.util.concurrent.TimeUnit)" title="class or interface in stormpot"><CODE>Config.setTTL(long, TimeUnit)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="constructorMustThrowOnNullAllocator(stormpot.PoolFixture)"><!-- --></A><H3>
constructorMustThrowOnNullAllocator</H3>
<PRE>
public void <B>constructorMustThrowOnNullAllocator</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</PRE>
<DL>
<DD>Prevent the creation of pools with a null Allocator.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - <DT><B>See Also:</B><DD><A HREF="../../apidocs/stormpot/Config.html?is-external=true#setAllocator(stormpot.Allocator)" title="class or interface in stormpot"><CODE>Config.setAllocator(Allocator)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="preventClaimFromPoolThatIsShutDown(stormpot.PoolFixture)"><!-- --></A><H3>
preventClaimFromPoolThatIsShutDown</H3>
<PRE>
public void <B>preventClaimFromPoolThatIsShutDown</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                        throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>It is not possible to claim from a pool that has been shut down. Doing
 so will cause an IllegalStateException to be thrown. This must take
 effect as soon as shutdown has been called. So the fact that claim()
 becomes unusable happens-before the pool shutdown process completes.
 The memory effects of this are not tested for, but I don't think it is
 possible to implement in a thread-safe manner and not provide the
 memory effects that we want.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="preventClaimWithTimeoutFromPoolThatIsShutDown(stormpot.PoolFixture)"><!-- --></A><H3>
preventClaimWithTimeoutFromPoolThatIsShutDown</H3>
<PRE>
public void <B>preventClaimWithTimeoutFromPoolThatIsShutDown</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                   throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Trying to claim-with-timeout from a pool that has been shut down will
 throw an IllegalStateException.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE><DT><B>See Also:</B><DD><A HREF="../stormpot/PoolTest.html#preventClaimFromPoolThatIsShutDown(stormpot.PoolFixture)"><CODE>preventClaimFromPoolThatIsShutDown(PoolFixture)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="mustReplaceExpiredPoolables(stormpot.PoolFixture)"><!-- --></A><H3>
mustReplaceExpiredPoolables</H3>
<PRE>
public void <B>mustReplaceExpiredPoolables</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                 throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Objects in the pool only live for a certain amount of time, and then
 they must be replaced/renewed. Pools should generally try to renew
 before the timeout elapses for the given object, but we don't test for
 that here.
 We set the TTL to be 1 milliseconds, because that is short enough that
 we can wait for it in a spin-loop. This way, the objects will always
 appear to have expired when checked. This means that every claim will
 always allocate a new object, and so our two claims will translate to
 at least two allocations, which is what we check for. Note that the TTL
 is so short that newly allocated objects might actually expire before a
 claim call can complete, and thus more than the expected two allocations
 are possible. This is why we check for *at least* two allocations.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="mustDeallocateExpiredPoolablesAndStayWithinSizeLimit(stormpot.PoolFixture)"><!-- --></A><H3>
mustDeallocateExpiredPoolablesAndStayWithinSizeLimit</H3>
<PRE>
public void <B>mustDeallocateExpiredPoolablesAndStayWithinSizeLimit</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                          throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>The size limit on a pool is strict, unless specially (as in a
 non-standard way) configured otherwise. A pool is not allowed to 
 have more objects allocated than the size, under any circumstances.
 So, when the pool renews an object it must make ensure that the
 deallocation of the old object happens-before the allocation of the
 new object.
 We test for this by configuring a pool with a timeout of one millisecond.
 Then we claim an release an object, and wait for 2 milliseconds. Now the
 object is expired, and must therefore be re-allocated before the next
 claim can return. So we do a claim (but no release) and check that we have
 had at least one deallocation. Note that our TTL is so short, that an
 object might expire before a claim call can complete, so this is why we
 check for *at least* one deallocation.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE><DT><B>See Also:</B><DD><A HREF="../../apidocs/stormpot/Config.html?is-external=true#setSize(int)" title="class or interface in stormpot"><CODE>Config.setSize(int)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="mustDeallocateAllPoolablesBeforeShutdownTaskReturns(stormpot.PoolFixture)"><!-- --></A><H3>
mustDeallocateAllPoolablesBeforeShutdownTaskReturns</H3>
<PRE>
public void <B>mustDeallocateAllPoolablesBeforeShutdownTaskReturns</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                         throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>When we call shutdown() on a pool, the shutdown process is initiated and
 the call returns a Completion object. A call to await() on this
 Completion object will not return until the shutdown process has been
 completed.
 A shutdown process is not complete until all Poolables in the pool have
 been deallocated. This means that any claimed objects must be released,
 all the deallocations must have returned.
 We test for this effect by making a pool of size 2 and claim both objects.
 Then we release them. The order is important, to prevent the allocation
 of just one object that is then reused. Then we shut the pool down and
 wait for it to finish. After this, we must observe that exactly 2
 deallocations have occurred.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="shutdownCallMustReturnFastIfPoolablesAreStillClaimed(stormpot.PoolFixture)"><!-- --></A><H3>
shutdownCallMustReturnFastIfPoolablesAreStillClaimed</H3>
<PRE>
public void <B>shutdownCallMustReturnFastIfPoolablesAreStillClaimed</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                          throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>So awaiting the shut down completion cannot return before all
 claimed objects are both released and deallocated. Likewise, the
 initiation of the shut down process - the call to shutdown() - must
 decidedly NOT wait for any claimed objects to be released, before the
 call returns.
 We test for this effect by creating a pool and claiming and object
 without ever releasing it. Then we call shutdown, without ever awaiting
 its completion. The test passes if this does not dead-lock, hence the
 test timeout.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="shutdownMustNotDeallocateClaimedPoolables(stormpot.PoolFixture)"><!-- --></A><H3>
shutdownMustNotDeallocateClaimedPoolables</H3>
<PRE>
public void <B>shutdownMustNotDeallocateClaimedPoolables</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                               throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>We have verified that the call to shutdown on a pool does not block on
 claimed objects, and we have verified that all objects are deallocated
 when the shut down completes. Now we need to verify that the release of
 a claimed objects happens-before that object is deallocated as part of
 the shut down process.
 We test for this effect by claiming an object from a pool, never to
 release it again. Then we initiate the shut down process. We await the
 completion of the shut down process with a very short timeout, to be
 sure that the process has actually started. This is to thwart any data
 race that might otherwise be lurking. Then finally we assert that the
 claimed object (the only one allocated) have not been deallocated.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="awaitOnShutdownMustReturnWhenClaimedObjectsAreReleased(stormpot.PoolFixture)"><!-- --></A><H3>
awaitOnShutdownMustReturnWhenClaimedObjectsAreReleased</H3>
<PRE>
public void <B>awaitOnShutdownMustReturnWhenClaimedObjectsAreReleased</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                            throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>We know from the previous test, that awaiting the shut down completion
 will wait for any claimed objects to be released. However, once those
 objects are released, we must also make sure that the shut down process
 actually resumes and eventually completes as a result.
 We test this by claiming and object and starting the shut down process.
 Then we set another thread to await the completion of the shut down
 process, and make sure that it actually enters the WAITING state.
 Then we release the claimed object and try to join the thread. If we
 manage to join the thread, then the shut down process has completed, and
 the test pass if this all happens within the test timeout.
 When a thread is in the WAITING state, it means that it is waiting for
 another thread to do something that will let it resume. In our case,
 the thread is waiting for someone to release the claimed object.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="awaitWithTimeoutMustReturnFalseIfTimeoutElapses(stormpot.PoolFixture)"><!-- --></A><H3>
awaitWithTimeoutMustReturnFalseIfTimeoutElapses</H3>
<PRE>
public void <B>awaitWithTimeoutMustReturnFalseIfTimeoutElapses</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                     throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>The await with timeout on the Completion of the shut down process
 must return false if the timeout elapses, as is the typical contract
 of such methods in java.util.concurrent.
 We are going to assume that the implementation adheres to the requested
 timeout within reasonable margins, because the implementations are
 probably going to delegate this call to java.util.concurrent anyway.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="awaitWithTimeoutMustReturnTrueIfCompletesWithinTimeout(stormpot.PoolFixture)"><!-- --></A><H3>
awaitWithTimeoutMustReturnTrueIfCompletesWithinTimeout</H3>
<PRE>
public void <B>awaitWithTimeoutMustReturnTrueIfCompletesWithinTimeout</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                            throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>We have verified that await with timeout returns false if the timeout
 elapses. We also have to make sure that the call returns true if the
 shut down process completes within the timeout.
 We test for this by claiming an object, start the shut down process,
 set a thread to await the completion with a timeout, then release the
 claimed object and join the thread. The result will be put in an
 AtomicBoolean, which then must contain true after the thread has been
 joined. And this must all happen before the test itself times out.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="awaitingOnAlreadyCompletedShutDownMustNotBlock(stormpot.PoolFixture)"><!-- --></A><H3>
awaitingOnAlreadyCompletedShutDownMustNotBlock</H3>
<PRE>
public void <B>awaitingOnAlreadyCompletedShutDownMustNotBlock</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                    throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>We have verified that the await methods works as intended, if you
 begin your awaiting while the shut down process is still undergoing.
 However, we must also make sure that further calls to await after the
 shut down process has completed, do not block.
 We do this by shutting a pool down, and then make a number of await calls
 to the shut down Completion. These calls must all return before the
 timeout of the test elapses.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="blockedClaimMustThrowWhenPoolIsShutDown(stormpot.PoolFixture)"><!-- --></A><H3>
blockedClaimMustThrowWhenPoolIsShutDown</H3>
<PRE>
public void <B>blockedClaimMustThrowWhenPoolIsShutDown</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                             throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>A call to claim on a pool that has been, or is in the process of being,
 shut down, will throw an IllegalStateException. So should calls that
 are blocked on claim when the shut down process is initiated.
 To test this, we create a pool with one object and claim it. Then we
 set another thread to also claim an object. This thread will block
 because the pool has been depleted. To make sure of this, we wait for
 the thread to enter the WAITING state. Then we start the shut down
 process of the pool, release the object and join the thread we started.
 If the call to claim throws an exception in the other thread, then it
 will be put in an AtomicReference, and we assert that it is indeed an
 IllegalStateException.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="blockedClaimWithTimeoutMustThrowWhenPoolIsShutDown(stormpot.PoolFixture)"><!-- --></A><H3>
blockedClaimWithTimeoutMustThrowWhenPoolIsShutDown</H3>
<PRE>
public void <B>blockedClaimWithTimeoutMustThrowWhenPoolIsShutDown</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                        throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>A thread that is waiting in claim-with-timeout when the pool is shut
 down, must quickly unblock and receive an IllegalStateException.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE><DT><B>See Also:</B><DD><A HREF="../stormpot/PoolTest.html#blockedClaimMustThrowWhenPoolIsShutDown(stormpot.PoolFixture)"><CODE>blockedClaimMustThrowWhenPoolIsShutDown(PoolFixture)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="mustNotDeallocateTheSameObjectMoreThanOnce(stormpot.PoolFixture)"><!-- --></A><H3>
mustNotDeallocateTheSameObjectMoreThanOnce</H3>
<PRE>
public void <B>mustNotDeallocateTheSameObjectMoreThanOnce</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Clients might hold on to objects after they have been released. This is
 a user error, but pools must still maintain a coherent allocation and
 deallocation pattern toward the Allocator.
 We test this by configuring a pool with a short TTL so that the objects
 will be deallocated as soon as possible. Then we claim an object, wait
 the TTL out and release it numerous times. Then we claim another object
 to guarantee that the deallocation of the first object have taken place
 when we check the deallocation list for duplicates. The pass if we don't
 find any.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="shutdownMustNotDeallocateEmptySlots(stormpot.PoolFixture)"><!-- --></A><H3>
shutdownMustNotDeallocateEmptySlots</H3>
<PRE>
public void <B>shutdownMustNotDeallocateEmptySlots</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                         throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>The shutdown procedure might be tempted to blindly iterate the pool
 data structure and deallocate every possible slot. However, slots that
 are empty should not be deallocated. In fact, the pool should never
 try to deallocate any null value.
 We attempt to test for this by having a special Allocator that flags
 a boolean if a null was deallocated. Then we create a pool with the
 Allocator and a negative TTL, and claim and release an object.
 Then we shut the pool down. After the shut down procedure completes,
 we check that no nulls were deallocated.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="mustPropagateExceptionsFromAllocateThroughClaim(stormpot.PoolFixture)"><!-- --></A><H3>
mustPropagateExceptionsFromAllocateThroughClaim</H3>
<PRE>
public void <B>mustPropagateExceptionsFromAllocateThroughClaim</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                     throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Pools must be prepared in the event that an Allocator throws a
 RuntimeException. If it is not possible to allocate an object, then
 the pool must throw a PoolException.
 Preferably, this PoolException should wrap the original RuntimeException
 from the Allocator, but we do not test for this here.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE><DT><B>See Also:</B><DD><A HREF="../../apidocs/stormpot/PoolException.html?is-external=true" title="class or interface in stormpot"><CODE>PoolException</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="mustPropagateExceptionsFromAllocateThroughClaimWithTimeout(stormpot.PoolFixture)"><!-- --></A><H3>
mustPropagateExceptionsFromAllocateThroughClaimWithTimeout</H3>
<PRE>
public void <B>mustPropagateExceptionsFromAllocateThroughClaimWithTimeout</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                                throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>If allocate throws an exception, then a later claim or claim-with-timeout
 must propagate it wrapped in a PoolException.
 We test the claim-with-timeout case here.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE><DT><B>See Also:</B><DD><A HREF="../stormpot/PoolTest.html#mustPropagateExceptionsFromAllocateThroughClaim(stormpot.PoolFixture)"><CODE>mustPropagateExceptionsFromAllocateThroughClaim(PoolFixture)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="mustStillBeUsableAfterExceptionInAllocate(stormpot.PoolFixture)"><!-- --></A><H3>
mustStillBeUsableAfterExceptionInAllocate</H3>
<PRE>
public void <B>mustStillBeUsableAfterExceptionInAllocate</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                               throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>A pool must not break its internal invariants if an Allocator throws an
 exception in allocate, and they must still be usable after the exception
 has bubbled out.
 We test this by configuring an Allocator that throws an exception if a
 boolean variable is true, or allocates as normal if not. On the first
 call to claim, we catch the exception that propagates out of the pool
 and flip the boolean. Then the next call to claim must return a non-null
 object within the test timeout.
 If it does not, then the pool might have broken locks or it might have
 garbage in the slot location.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="mustSwallowExceptionsFromDeallocateThroughRelease(stormpot.PoolFixture)"><!-- --></A><H3>
mustSwallowExceptionsFromDeallocateThroughRelease</H3>
<PRE>
public void <B>mustSwallowExceptionsFromDeallocateThroughRelease</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                       throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>We cannot guarantee that exceptions from deallocating objects will
 propagate out through release, because the actual deallocation might be
 done asynchronously in a different thread.
 So instead, we are going to guarantee the opposite: that calling release
 on an object will never propagate, or even throw, any exceptions ever.
 Users of a pool who are interested in logging what exceptions might be
 thrown by their allocators deallocate method, are going to have to wrap
 their allocators in try-catching and logging code.
 We test this by configuring the pool with an Allocator that always throws
 on deallocate, and a very short TTL. Then we claim and release an object,
 spin the TTL out and then claim another one. This ensures that the
 deallocation actually takes place, because full pools guarantee that
 the deallocation of an expired object happens before the allocation
 of its replacement.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="mustSwallowExceptionsFromDeallocateThroughShutdown(stormpot.PoolFixture)"><!-- --></A><H3>
mustSwallowExceptionsFromDeallocateThroughShutdown</H3>
<PRE>
public void <B>mustSwallowExceptionsFromDeallocateThroughShutdown</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                        throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>While it is technically possible to propagate exceptions from an
 Allocators deallocate method during the shutdown procedure, it would not
 be a desirable behaviour because it would be inconsistent with how this
 works for the release method on Poolable - and Slot, for that matter.
 People who are interested in the exceptions that deallocate might throw,
 should wrap their Allocators in implementations that log them. If they
 do this, then they will already have a means for accessing the exceptions
 thrown. As such, there is no point in also logging the exceptions in the
 shut down procedure.
 We test this by configuring a pool with an Allocator that always throws
 on deallocate, in addition to counting deallocations. We also keep the
 standard TTL configuration to prevent the objects from being immediately
 deallocated when they are released, and we set the size to 2. Then we
 claim two objects and then release them. This means that two objects are
 now live in the pool. Then we shut the pool down.
 The test passes if the shut down procedure completes without throwing
 any exceptions, and we observe exactly 2 deallocations.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="awaitOnCompletionWhenInterruptedMustThrow(stormpot.PoolFixture)"><!-- --></A><H3>
awaitOnCompletionWhenInterruptedMustThrow</H3>
<PRE>
public void <B>awaitOnCompletionWhenInterruptedMustThrow</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                               throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Calling await on a completion when your thread is interrupted, must
 throw an InterruptedException.
 In this particular case we make sure that the shut down procedure has
 not yet completed, by claiming an object from the pool without releasing
 it.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="awaitWithTimeoutOnCompletionWhenInterruptedMustThrow(stormpot.PoolFixture)"><!-- --></A><H3>
awaitWithTimeoutOnCompletionWhenInterruptedMustThrow</H3>
<PRE>
public void <B>awaitWithTimeoutOnCompletionWhenInterruptedMustThrow</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                          throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Calling await with timeout on a completion when your thread is
 interrupted must, just as await without timeout, throw an
 InterruptedException
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="awaitOnCompletionMustThrowUponInterruption(stormpot.PoolFixture)"><!-- --></A><H3>
awaitOnCompletionMustThrowUponInterruption</H3>
<PRE>
public void <B>awaitOnCompletionMustThrowUponInterruption</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>A thread that is waiting in await, for a completion to finish, must
 throw an InterruptedException if it is interrupted.
 We test this by starting another thread to interrupt us, as soon as it
 observes that our thread enters the WAITING state.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="awaitWithTimeoutOnCompletionMustThrowUponInterruption(stormpot.PoolFixture)"><!-- --></A><H3>
awaitWithTimeoutOnCompletionMustThrowUponInterruption</H3>
<PRE>
public void <B>awaitWithTimeoutOnCompletionMustThrowUponInterruption</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                           throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>A thread that is awaiting the completion of a shut down procedure with
 a timeout, must throw an InterruptedException if it is interrupted.
 We test this the same way we test without the timeout. The only difference
 is that our thread will enter the TIMED_WAITING state because of the
 timeout.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="awaitOnCompletionWhenInterruptedMustClearInterruption(stormpot.PoolFixture)"><!-- --></A><H3>
awaitOnCompletionWhenInterruptedMustClearInterruption</H3>
<PRE>
public void <B>awaitOnCompletionWhenInterruptedMustClearInterruption</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                           throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>As per the contract of throwing an InterruptedException, if the
 await of an unfinished completion throws an InterruptedException, then
 they must also clear the interrupted status.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="awaitOnFinishedCompletionWhenInterruptedMustThrow(stormpot.PoolFixture)"><!-- --></A><H3>
awaitOnFinishedCompletionWhenInterruptedMustThrow</H3>
<PRE>
public void <B>awaitOnFinishedCompletionWhenInterruptedMustThrow</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                       throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</A></PRE>
<DL>
<DD>Calling await on a completion when your thread is interrupted,
 must throw an InterruptedException - even if the shut down procedure
 has completed.
 We test this by first shutting the pool down cleanly. Then interrupting
 the thread, and then try to shut the pool down again.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="awaitWithTimeoutOnFinishedCompletionWhenInterruptedMustThrow(stormpot.PoolFixture)"><!-- --></A><H3>
awaitWithTimeoutOnFinishedCompletionWhenInterruptedMustThrow</H3>
<PRE>
public void <B>awaitWithTimeoutOnFinishedCompletionWhenInterruptedMustThrow</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                                  throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</A></PRE>
<DL>
<DD>Calling await with a timeout on a finished completion when your thread
 is interrupted must, just as with calling await without a timeout,
 throw an InterruptedException.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="awaitOnFinishedCompletionMustClearInterruption(stormpot.PoolFixture)"><!-- --></A><H3>
awaitOnFinishedCompletionMustClearInterruption</H3>
<PRE>
public void <B>awaitOnFinishedCompletionMustClearInterruption</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)</PRE>
<DL>
<DD>As per the contract of throwing an InterruptedException, the above must
 also clear the threads interrupted status.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="claimMustThrowIfAllocationReturnsNull(stormpot.PoolFixture)"><!-- --></A><H3>
claimMustThrowIfAllocationReturnsNull</H3>
<PRE>
public void <B>claimMustThrowIfAllocationReturnsNull</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                           throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Allocators must never return <code>null</code>, and if they do, then a
 call to claim must throw a PoolException to indicate this fact.
 We test this by configuring the pool with an Allocator that always
 returns null from allocate, and then we try to claim from this pool.
 This call to claim must then throw a PoolException.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE><DT><B>See Also:</B><DD><A HREF="../../apidocs/stormpot/Allocator.html?is-external=true#allocate(stormpot.Slot)" title="class or interface in stormpot"><CODE>Allocator.allocate(Slot)</CODE></A>, 
<A HREF="../../apidocs/stormpot/PoolException.html?is-external=true" title="class or interface in stormpot"><CODE>PoolException</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="claimWithTimeoutMustThrowIfAllocationReturnsNull(stormpot.PoolFixture)"><!-- --></A><H3>
claimWithTimeoutMustThrowIfAllocationReturnsNull</H3>
<PRE>
public void <B>claimWithTimeoutMustThrowIfAllocationReturnsNull</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                      throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Even claim with timeout must throw a PoolException if an Allocator
 returns <code>null</code>.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE><DT><B>See Also:</B><DD><A HREF="../stormpot/PoolTest.html#claimMustThrowIfAllocationReturnsNull(stormpot.PoolFixture)"><CODE>claimMustThrowIfAllocationReturnsNull(PoolFixture)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="claimWhenInterruptedMustThrow(stormpot.PoolFixture)"><!-- --></A><H3>
claimWhenInterruptedMustThrow</H3>
<PRE>
public void <B>claimWhenInterruptedMustThrow</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                   throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Threads that are already interrupted upon entry to the claim method, must
 promptly be met with an InterruptedException. This behaviour matches that
 of other interruptible methods in java.util.concurrent.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE><DT><B>See Also:</B><DD><A HREF="../../apidocs/stormpot/Pool.html?is-external=true" title="class or interface in stormpot"><CODE>Pool</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="claimWithTimeoutWhenInterruptedMustThrow(stormpot.PoolFixture)"><!-- --></A><H3>
claimWithTimeoutWhenInterruptedMustThrow</H3>
<PRE>
public void <B>claimWithTimeoutWhenInterruptedMustThrow</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                              throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE><DT><B>See Also:</B><DD><A HREF="../stormpot/PoolTest.html#claimWhenInterruptedMustThrow(stormpot.PoolFixture)"><CODE>claimWhenInterruptedMustThrow(PoolFixture)</CODE></A>, 
<A HREF="../../apidocs/stormpot/Pool.html?is-external=true" title="class or interface in stormpot"><CODE>Pool</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="blockedClaimMustThrowUponInterruption(stormpot.PoolFixture)"><!-- --></A><H3>
blockedClaimMustThrowUponInterruption</H3>
<PRE>
public void <B>blockedClaimMustThrowUponInterruption</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                           throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>The claim methods checks whether the current thread is interrupted upon
 entry, but perhaps what is more important is the interruption of a claim
 call that is already waiting when the thread is interrupted.
 We test for this by setting a thread to interrupt us, when our thread
 enters the WAITING or TIMED_WAITING states. Then we make a call to the
 appropriate claim method. If it throws an InterruptException, then the
 test passes.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="blockedClaimWithTimeoutMustThrowUponInterruption(stormpot.PoolFixture)"><!-- --></A><H3>
blockedClaimWithTimeoutMustThrowUponInterruption</H3>
<PRE>
public void <B>blockedClaimWithTimeoutMustThrowUponInterruption</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                      throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE><DT><B>See Also:</B><DD><A HREF="../stormpot/PoolTest.html#blockedClaimMustThrowUponInterruption(stormpot.PoolFixture)"><CODE>blockedClaimMustThrowUponInterruption(PoolFixture)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="throwingInterruptedExceptionFromClaimMustClearInterruptedFlag(stormpot.PoolFixture)"><!-- --></A><H3>
throwingInterruptedExceptionFromClaimMustClearInterruptedFlag</H3>
<PRE>
public void <B>throwingInterruptedExceptionFromClaimMustClearInterruptedFlag</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                                   throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>As per the general contract of interruptible methods, throwing an
 InterruptedException will clear the interrupted flag on the thread.
 This must also hold for the claim methods.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="claimMustStayWithinDeadlineEvenIfAllocatorBlocks(stormpot.PoolFixture)"><!-- --></A><H3>
claimMustStayWithinDeadlineEvenIfAllocatorBlocks</H3>
<PRE>
public void <B>claimMustStayWithinDeadlineEvenIfAllocatorBlocks</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                      throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>A call to claim with time-out must complete within the time-out period
 even if the Allocator never returns.
 We test for this by configuring an Allocator that will never return from
 any calls to allocate, and then calling claim with a time-out on the pool.
 This claim-call must then complete before the time-out on the test case
 itself elapses.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE><DT><B>See Also:</B><DD><A HREF="../../apidocs/stormpot/Pool.html?is-external=true" title="class or interface in stormpot"><CODE>Pool</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="claimMustStayWithinTimeoutEvenIfExpiredObjectIsReleased(stormpot.PoolFixture)"><!-- --></A><H3>
claimMustStayWithinTimeoutEvenIfExpiredObjectIsReleased</H3>
<PRE>
public void <B>claimMustStayWithinTimeoutEvenIfExpiredObjectIsReleased</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                             throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Claim with timeout must adhere to its timeout value. Some pool
 implementations do the waiting in a loop, and if they don't do it right,
 they might end up resetting the timeout every time they loop. This test
 tries to ensure that that no such resetting can happen because an object
 is released back into the pool. This may not cover all cases that are
 possible with the different pool implementations, but it is at least a
 start. And one that can be generally tested for across pool
 implementations. Chances are, that if a pool handles this specific case,
 then it handles all cases that are relevant to its implementation.
 <p>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="claimWithTimeoutValueLessThanOneMustReturnImmediately(stormpot.PoolFixture)"><!-- --></A><H3>
claimWithTimeoutValueLessThanOneMustReturnImmediately</H3>
<PRE>
public void <B>claimWithTimeoutValueLessThanOneMustReturnImmediately</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                           throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>When claim is called with a timeout less than one, then it means that
 no (observable amount of) waiting should take place.
 <p>
 We test for this by going through the numbers 0 to 99, both inclusive,
 and call claim with those numbers as timeout values. The test is
 considered to have passed, if this process completes within the 300
 millisecond timeout on the test case.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE><DT><B>See Also:</B><DD><A HREF="../../apidocs/stormpot/Pool.html?is-external=true#claim(long, java.util.concurrent.TimeUnit)" title="class or interface in stormpot"><CODE>Pool.claim(long, TimeUnit)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="claimWithNullTimeUnitMustThrow(stormpot.PoolFixture)"><!-- --></A><H3>
claimWithNullTimeUnitMustThrow</H3>
<PRE>
public void <B>claimWithNullTimeUnitMustThrow</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                    throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>One must provide a TimeUnit to a claim call with timeout. Otherwise the
 timeout value cannot be made sense of. So if you pass a null in, then
 that's an illegal argument.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="awaitCompletionWithTimeoutLessThanOneMustReturnImmediately(stormpot.PoolFixture)"><!-- --></A><H3>
awaitCompletionWithTimeoutLessThanOneMustReturnImmediately</H3>
<PRE>
public void <B>awaitCompletionWithTimeoutLessThanOneMustReturnImmediately</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                                throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>When await is called on a shutdown Completion with a timeout value less
 than one, then no amount of waiting must take place.
 <p>
 We test for this by depleting a pool and initiating the shut-down
 procedure. The fact that the pool is depleted, means that the shutdown
 procedure will not be able to finish. In other words, we know that it is
 in progress for our subsequent await calls.
 Then we call await on the shut-down Completion object, giving timeout
 values ranging from zero to -99. These awaits must all complete before the
 test itself times out.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE><DT><B>See Also:</B><DD><A HREF="../../apidocs/stormpot/Completion.html?is-external=true" title="class or interface in stormpot"><CODE>Completion</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="awaitCompletionWithNullTimeUnitMustThrow(stormpot.PoolFixture)"><!-- --></A><H3>
awaitCompletionWithNullTimeUnitMustThrow</H3>
<PRE>
public void <B>awaitCompletionWithNullTimeUnitMustThrow</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                              throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>One must provide a TimeUnit argument when awaiting the completion of a
 shut-down procedure, with a timeout. Otherwise the timeout value does not
 make any sense. Passing null is thus an illegal argument.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE><DT><B>See Also:</B><DD><A HREF="../../apidocs/stormpot/Completion.html?is-external=true" title="class or interface in stormpot"><CODE>Completion</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="mustCompleteShutDownEvenIfAllSlotsHaveNullErrors(stormpot.PoolFixture)"><!-- --></A><H3>
mustCompleteShutDownEvenIfAllSlotsHaveNullErrors</H3>
<PRE>
public void <B>mustCompleteShutDownEvenIfAllSlotsHaveNullErrors</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                      throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</A></PRE>
<DL>
<DD>Even if the Allocator has never made a successful allocation, the pool
 must still be able to complete its shut-down procedure.
 In this case we test with an allocator that always returns null.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="mustCompleteShutDownEvenIfAllSlotsHaveAllocationErrors(stormpot.PoolFixture)"><!-- --></A><H3>
mustCompleteShutDownEvenIfAllSlotsHaveAllocationErrors</H3>
<PRE>
public void <B>mustCompleteShutDownEvenIfAllSlotsHaveAllocationErrors</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                            throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</A></PRE>
<DL>
<DD>As with
 <A HREF="../stormpot/PoolTest.html#mustCompleteShutDownEvenIfAllSlotsHaveNullErrors(stormpot.PoolFixture)"><CODE>mustCompleteShutDownEvenIfAllSlotsHaveNullErrors(PoolFixture)</CODE></A>,
 the pool must be able to shut down if it has never been able to allocate
 anything.
 In this case we test with an allocator that always throws an exception.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="mustBeAbleToShutDownEvenIfInterrupted(stormpot.PoolFixture)"><!-- --></A><H3>
mustBeAbleToShutDownEvenIfInterrupted</H3>
<PRE>
public void <B>mustBeAbleToShutDownEvenIfInterrupted</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                           throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</A></PRE>
<DL>
<DD>Calling shutdown on a pool while being interrupted must still start the
 shut-down procedure.
 We test for this by initiating the shut-down procedure on a pool while
 being interrupted. Then we clear our interrupted flag and await the
 completion of the shut-down procedure. The procedure must complete within
 the test timeout. If it does not, then that is taken as evidence that
 the procedure did NOT start, and so the test fails.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</A></CODE><DT><B>See Also:</B><DD><A HREF="../../apidocs/stormpot/Pool.html?is-external=true" title="class or interface in stormpot"><CODE>Pool</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="callingShutdownMustNotAffectInterruptionStatus(stormpot.PoolFixture)"><!-- --></A><H3>
callingShutdownMustNotAffectInterruptionStatus</H3>
<PRE>
public void <B>callingShutdownMustNotAffectInterruptionStatus</B>(<A HREF="../stormpot/PoolFixture.html" title="interface in stormpot">PoolFixture</A>&nbsp;fixture)
                                                    throws <A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</A></PRE>
<DL>
<DD>Initiating the shut-down procedure must not influence the threads
 interruption status.
 We test for this by calling shutdown on the pool while being interrupted.
 Then we check that we are still interrupted.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fixture</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</A></CODE><DT><B>See Also:</B><DD><A HREF="../../apidocs/stormpot/Pool.html?is-external=true" title="class or interface in stormpot"><CODE>Pool</CODE></A></DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/PoolTest.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../stormpot/PoolFixtures.html" title="class in stormpot"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../stormpot/UnitKit.html" title="class in stormpot"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../index.html?stormpot/PoolTest.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="PoolTest.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright &#169; 2011. All Rights Reserved.
</BODY>
</HTML>
