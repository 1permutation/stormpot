<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_72) on Sat Nov 22 13:35:10 CET 2014 -->
<meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
<title>stormpot (stormpot 2.3 API)</title>
<meta name="date" content="2014-11-22">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="stormpot (stormpot 2.3 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Package</li>
<li><a href="../stormpot/bpool/package-summary.html">Next Package</a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?stormpot/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;stormpot</h1>
<div class="docSummary">
<div class="block">Stormpot</div>
</div>
<p>See:&nbsp;<a href="#package_description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/Allocator.html" title="interface in stormpot">Allocator</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/Completion.html" title="interface in stormpot">Completion</a></td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/Expiration.html" title="interface in stormpot">Expiration</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/LifecycledPool.html" title="interface in stormpot">LifecycledPool</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/LifecycledResizablePool.html" title="interface in stormpot">LifecycledResizablePool</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/ManagedPool.html" title="interface in stormpot">ManagedPool</a></td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/MetricsRecorder.html" title="interface in stormpot">MetricsRecorder</a></td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/Pool.html" title="interface in stormpot">Pool</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a></td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/Reallocator.html" title="interface in stormpot">Reallocator</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/ResizablePool.html" title="interface in stormpot">ResizablePool</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/Slot.html" title="interface in stormpot">Slot</a></td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/SlotInfo.html" title="interface in stormpot">SlotInfo</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/BlazePool.html" title="class in stormpot">BlazePool</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/Config.html" title="class in stormpot">Config</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block">The basic configuration "bean" class.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/QueuePool.html" title="class in stormpot">QueuePool</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/TimeExpiration.html" title="class in stormpot">TimeExpiration</a></td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/Timeout.html" title="class in stormpot">Timeout</a></td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/TimeSpreadExpiration.html" title="class in stormpot">TimeSpreadExpiration</a></td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Exception Summary table, listing exceptions, and an explanation">
<caption><span>Exception Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Exception</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/PoolException.html" title="class in stormpot">PoolException</a></td>
<td class="colLast">
<div class="block"><div class="paragraph"></div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package_description">
<!--   -->
</a>
<h2 title="Package stormpot Description">Package stormpot Description</h2>
<div class="block"><h1>Stormpot</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Stormpot is a generic, thread-safe and fast object pooling library.</p>
</div>
<div class="paragraph">
<p>The object pools themselves implement the <a href="../stormpot/Pool.html" title="interface in stormpot"><code>Pool</code></a> interface,
or one or both of the <a href="../stormpot/LifecycledPool.html" title="interface in stormpot"><code>LifecycledPool</code></a> or
<a href="../stormpot/ResizablePool.html" title="interface in stormpot"><code>ResizablePool</code></a> interfaces, or even the
<a href="../stormpot/LifecycledResizablePool.html" title="interface in stormpot"><code>LifecycledResizablePool</code></a> interface. The things you actually
want to pool must all implement the <a href="../stormpot/Poolable.html" title="interface in stormpot"><code>Poolable</code></a> interface, and
you must also provide an implementation of the <a href="../stormpot/Allocator.html" title="interface in stormpot"><code>Allocator</code></a>
interface as a factory to create your pooled objects.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="simplest_possible_usage">Simplest Possible Usage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stormpot has an invasive API which means that there is a minimum of things your
code needs to do to use it.
However, the requirements are quite benign, as this section is all about showing you.
The objects that you manage with a Stormpot pool needs to implement the <code>Poolable</code> interface. The absolute minimum amount of code required for its implementation is this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay"><code class="java language-java"><span style="color:#777">// MyPoolable.java - minimum Poolable implementation</span>
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">stormpot.Poolable</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">stormpot.Slot</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyPoolable</span> <span style="color:#088;font-weight:bold">implements</span> Poolable {
  <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> Slot slot;
  <span style="color:#088;font-weight:bold">public</span> MyPoolable(Slot slot) {
    <span style="color:#950">this</span>.slot = slot;
  }

  <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> release() {
    slot.release(<span style="color:#950">this</span>);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The object in essence just needs to keep its <code>Slot</code> instance around, and give itself as a parameter to the <code>Slot#release</code> method.
Now that we have a class of objects to pool, we need some way to tell Stormpot how to create them.
We do this by implementing the <code>Allocator</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay"><code class="java language-java"><span style="color:#777">// MyAllocator.java - minimum Allocator implementation</span>
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">stormpot.Allocator</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">stormpot.Slot</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyAllocator</span> <span style="color:#088;font-weight:bold">implements</span> Allocator&lt;MyPoolable&gt; {
  <span style="color:#088;font-weight:bold">public</span> MyPoolable allocate(Slot slot) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">Exception</span> {
    <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> MyPoolable(slot);
  }

  <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> deallocate(MyPoolable poolable) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">Exception</span> {
    <span style="color:#777">// Nothing to do here</span>
    <span style="color:#777">// But it's a perfect place to close sockets, files, etc.</span>
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s it.
Given a slot, create a <code>MyPoolable</code>.
Or given a <code>MyPoolable</code>, deallocate it.
And that is actually all the parts we need to start using Stormpot.
All that is left is a little bit of configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay"><code class="java language-java">    MyAllocator allocator = <span style="color:#080;font-weight:bold">new</span> MyAllocator();
    Config&lt;MyPoolable&gt; config = <span style="color:#080;font-weight:bold">new</span> Config&lt;MyPoolable&gt;().setAllocator(allocator);
    Pool&lt;MyPoolable&gt; pool = <span style="color:#080;font-weight:bold">new</span> BlazePool&lt;MyPoolable&gt;(config);
    Timeout timeout = <span style="color:#080;font-weight:bold">new</span> Timeout(<span style="color:#00D">1</span>, <span style="color:#0a8;font-weight:bold">TimeUnit</span>.SECONDS);

    MyPoolable object = pool.claim(timeout);
    <span style="color:#080;font-weight:bold">try</span> {
      <span style="color:#777">// Do stuff with 'object'.</span>
      <span style="color:#777">// Note that 'claim' will return 'null' if it times out!</span>
    } <span style="color:#080;font-weight:bold">finally</span> {
      <span style="color:#080;font-weight:bold">if</span> (object != <span style="color:#069">null</span>) {
        object.release();
      }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a <code>Config</code> object and set the allocator, then create a pool with the configuration and off we go!
The blocking methods <code>Pool#claim</code> and <code>Completion#await</code> both take <code>Timeout</code> objects as arguments.
These are immutable, and can easily be put in <code>static final</code> constants.
Note that <code>claim</code> returns <code>null</code> if the timeout elapses before an object can be claimed.
Also, using <code>try-finally</code> is a great way to make sure that you don&#8217;t forget to release the objects back into the pool.
Stormpot cannot prevent objects from leaking in user code, so if you lose the reference to an object that hasn&#8217;t been released back into the pool, it will not come back on its own.
Leaked objects can also cause problems with shutting the pool down, because the shut down procedure does not complete until all allocated objects are deallocated.
So if you have leaked objects, shutting the pool down will never complete normally.
You can still just halt the JVM, though.</p>
</div>
</div>
</div></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Package</li>
<li><a href="../stormpot/bpool/package-summary.html">Next Package</a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?stormpot/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2011-2014&#x2013;2014. All rights reserved.</small></p>
</body>
</html>
