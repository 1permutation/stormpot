<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_72) on Sun Aug 23 00:53:04 CEST 2015 -->
<meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
<title>stormpot (stormpot 2.4 API)</title>
<meta name="date" content="2015-08-23">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="stormpot (stormpot 2.4 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Package</li>
<li><a href="../stormpot/bpool/package-summary.html">Next Package</a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?stormpot/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;stormpot</h1>
<div class="docSummary">
<div class="block">Stormpot</div>
</div>
<p>See:&nbsp;<a href="#package_description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/Allocator.html" title="interface in stormpot">Allocator</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block">An Allocator is responsible for the creation and destruction of
<a href="../stormpot/Poolable.html" title="interface in stormpot"><code>Poolable</code></a> objects.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/Completion.html" title="interface in stormpot">Completion</a></td>
<td class="colLast">
<div class="block">A Completion represents some task that is going to be completed at some
point in the future, or maybe already has completed.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/Expiration.html" title="interface in stormpot">Expiration</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block">The expiration is used to determine if a given slot has expired, or
otherwise become invalid.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/LifecycledPool.html" title="interface in stormpot">LifecycledPool</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block">A LifecycledPool is a <a href="../stormpot/Pool.html" title="interface in stormpot"><code>Pool</code></a> that can be shut down to release any
internal resources it might be holding on to.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/LifecycledResizablePool.html" title="interface in stormpot">LifecycledResizablePool</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block">An interface for <a href="../stormpot/Pool.html" title="interface in stormpot"><code>Pool</code></a>s that are both
<a href="../stormpot/LifecycledPool.html" title="interface in stormpot"><code>life-cycled</code></a> and <a href="../stormpot/ResizablePool.html" title="interface in stormpot"><code>resizable</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/ManagedPool.html" title="interface in stormpot">ManagedPool</a></td>
<td class="colLast">
<div class="block">This is the JMX management interface for Stormpot object pools.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/MetricsRecorder.html" title="interface in stormpot">MetricsRecorder</a></td>
<td class="colLast">
<div class="block">A MetricsRecorder implementation supplies the pool with the ability to
record and report operational metrics.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/Pool.html" title="interface in stormpot">Pool</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block">A Pool is a self-renewable set of objects from which one can claim exclusive
access to elements, until they are released back into the pool.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a></td>
<td class="colLast">
<div class="block">Objects contained in a <a href="../stormpot/Pool.html" title="interface in stormpot"><code>Pool</code></a> must implement the Poolable interface
and adhere to its contract.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/Reallocator.html" title="interface in stormpot">Reallocator</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block">Reallocators are a special kind of <a href="../stormpot/Allocator.html" title="interface in stormpot"><code>Allocator</code></a> that can reallocate
<a href="../stormpot/Poolable.html" title="interface in stormpot"><code>Poolable</code></a>s that have expired.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/ResizablePool.html" title="interface in stormpot">ResizablePool</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block">ResizablePools are pools that can change their size after they have been
created.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/Slot.html" title="interface in stormpot">Slot</a></td>
<td class="colLast">
<div class="block">A Slot represents a location in a Pool where objects can be allocated into,
so that they can be claimed and released.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/SlotInfo.html" title="interface in stormpot">SlotInfo</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block">An informative little interface, used by <a href="../stormpot/Expiration.html" title="interface in stormpot"><code>Expiration</code></a> instances to
determine if a slot has expired or is still invalid for claiming.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/BlazePool.html" title="class in stormpot">BlazePool</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block">BlazePool is a highly optimised <a href="../stormpot/LifecycledResizablePool.html" title="interface in stormpot"><code>LifecycledResizablePool</code></a>
implementation that consists of a queues of Poolable instances, the access
to which is made faster with clever use of ThreadLocals.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/CompoundExpiration.html" title="class in stormpot">CompoundExpiration</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block">Provides a way to compose <a href="../stormpot/Expiration.html" title="interface in stormpot"><code>Expiration</code></a>s.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/Config.html" title="class in stormpot">Config</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block">The basic configuration "bean" class.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/QueuePool.html" title="class in stormpot">QueuePool</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block">QueuePool is a fairly simple <a href="../stormpot/LifecycledResizablePool.html" title="interface in stormpot"><code>LifecycledResizablePool</code></a> implementation
that basically consists of a queue of Poolable instances, and a Thread to
allocate them.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/TimeExpiration.html" title="class in stormpot">TimeExpiration</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block">This is a time based <a href="../stormpot/Expiration.html" title="interface in stormpot"><code>Expiration</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../stormpot/Timeout.html" title="class in stormpot">Timeout</a></td>
<td class="colLast">
<div class="block">A Timeout represents the maximum amount of time a caller is willing to wait
for a blocking operation to complete.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/TimeSpreadExpiration.html" title="class in stormpot">TimeSpreadExpiration</a>&lt;T extends <a href="../stormpot/Poolable.html" title="interface in stormpot">Poolable</a>&gt;</td>
<td class="colLast">
<div class="block">This is the standard time based <a href="../stormpot/Expiration.html" title="interface in stormpot"><code>Expiration</code></a>.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Exception Summary table, listing exceptions, and an explanation">
<caption><span>Exception Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Exception</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../stormpot/PoolException.html" title="class in stormpot">PoolException</a></td>
<td class="colLast">
<div class="block">The PoolException may be thrown by a pool implementation in a number of
circumstances:</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package_description">
<!--   -->
</a>
<h2 title="Package stormpot Description">Package stormpot Description</h2>
<div class="block"><h1>Stormpot</h1>
<div id="preamble">
<div class="sectionbody">
<p>Stormpot is a generic, thread-safe and fast object pooling library.</p>
<p>The object pools themselves implement the <a href="../stormpot/Pool.html" title="interface in stormpot"><code>Pool</code></a> interface,
or one or both of the <a href="../stormpot/LifecycledPool.html" title="interface in stormpot"><code>LifecycledPool</code></a> or
<a href="../stormpot/ResizablePool.html" title="interface in stormpot"><code>ResizablePool</code></a> interfaces, or even the
<a href="../stormpot/LifecycledResizablePool.html" title="interface in stormpot"><code>LifecycledResizablePool</code></a> interface. The things you actually
want to pool must all implement the <a href="../stormpot/Poolable.html" title="interface in stormpot"><code>Poolable</code></a> interface, and
you must also provide an implementation of the <a href="../stormpot/Allocator.html" title="interface in stormpot"><code>Allocator</code></a>
interface as a factory to create your pooled objects.</p>
</div>
</div>
<h2 id="simplest-possible-usage">Simplest Possible Usage</h2>
<div class="sectionbody">
<p>Stormpot has an invasive API which means that there is a minimum of things your
code needs to do to use it.
However, the requirements are quite benign, as this section is all about showing you.
The objects that you manage with a Stormpot pool needs to implement the <code>Poolable</code> interface. The absolute minimum amount of code required for its implementation is this:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// MyPoolable.java - minimum Poolable implementation</span>
<span class="keyword">import</span> <span class="include">stormpot.Poolable</span>;
<span class="keyword">import</span> <span class="include">stormpot.Slot</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">MyPoolable</span> <span class="directive">implements</span> Poolable {
  <span class="directive">private</span> <span class="directive">final</span> Slot slot;
  <span class="directive">public</span> MyPoolable(Slot slot) {
    <span class="local-variable">this</span>.slot = slot;
  }

  <span class="directive">public</span> <span class="type">void</span> release() {
    slot.release(<span class="local-variable">this</span>);
  }
}</code></pre>
</div>
</div>
<p>The object in essence just needs to keep its <code>Slot</code> instance around, and give itself as a parameter to the <code>Slot#release</code> method.
Now that we have a class of objects to pool, we need some way to tell Stormpot how to create them.
We do this by implementing the <code>Allocator</code> interface:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// MyAllocator.java - minimum Allocator implementation</span>
<span class="keyword">import</span> <span class="include">stormpot.Allocator</span>;
<span class="keyword">import</span> <span class="include">stormpot.Slot</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">MyAllocator</span> <span class="directive">implements</span> Allocator&lt;MyPoolable&gt; {
  <span class="directive">public</span> MyPoolable allocate(Slot slot) <span class="directive">throws</span> <span class="exception">Exception</span> {
    <span class="keyword">return</span> <span class="keyword">new</span> MyPoolable(slot);
  }

  <span class="directive">public</span> <span class="type">void</span> deallocate(MyPoolable poolable) <span class="directive">throws</span> <span class="exception">Exception</span> {
    <span class="comment">// Nothing to do here</span>
    <span class="comment">// But it's a perfect place to close sockets, files, etc.</span>
  }
}</code></pre>
</div>
</div>
<p>That&#8217;s it.
Given a slot, create a <code>MyPoolable</code>.
Or given a <code>MyPoolable</code>, deallocate it.
And that is actually all the parts we need to start using Stormpot.
All that is left is a little bit of configuration:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    MyAllocator allocator = <span class="keyword">new</span> MyAllocator();
    Config&lt;MyPoolable&gt; config = <span class="keyword">new</span> Config&lt;MyPoolable&gt;().setAllocator(allocator);
    Pool&lt;MyPoolable&gt; pool = <span class="keyword">new</span> BlazePool&lt;MyPoolable&gt;(config);
    Timeout timeout = <span class="keyword">new</span> Timeout(<span class="integer">1</span>, <span class="predefined-type">TimeUnit</span>.SECONDS);

    MyPoolable object = pool.claim(timeout);
    <span class="keyword">try</span> {
      <span class="comment">// Do stuff with 'object'.</span>
      <span class="comment">// Note that 'claim' will return 'null' if it times out!</span>
    } <span class="keyword">finally</span> {
      <span class="keyword">if</span> (object != <span class="predefined-constant">null</span>) {
        object.release();
      }
    }</code></pre>
</div>
</div>
<p>Create a <code>Config</code> object and set the allocator, then create a pool with the configuration and off we go!
The blocking methods <code>Pool#claim</code> and <code>Completion#await</code> both take <code>Timeout</code> objects as arguments.
These are immutable, and can easily be put in <code>static final</code> constants.
Note that <code>claim</code> returns <code>null</code> if the timeout elapses before an object can be claimed.
Also, using <code>try-finally</code> is a great way to make sure that you don&#8217;t forget to release the objects back into the pool.
Stormpot cannot prevent objects from leaking in user code, so if you lose the reference to an object that hasn&#8217;t been released back into the pool, it will not come back on its own.
Leaked objects can also cause problems with shutting the pool down, because the shut down procedure does not complete until all allocated objects are deallocated.
So if you have leaked objects, shutting the pool down will never complete normally.
You can still just halt the JVM, though.</p>
</div></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Package</li>
<li><a href="../stormpot/bpool/package-summary.html">Next Package</a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?stormpot/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2011-2014&#x2013;2015. All rights reserved.</small></p>
</body>
</html>
